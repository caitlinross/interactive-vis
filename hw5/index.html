<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Test</title>
        <style>
        </style>
    </head>
    <body>
        <script type="text/javascript" src="d3.js"></script>
        <script type="text/javascript" src="d3.parcoords.js"></script>
        <link rel="stylesheet" type="text/css" href="d3.parcoords.css">
        <script type="text/javascript">
        // Adapted from https://syntagmatic.github.io/parallel-coordinates/ by Kai Chang
        // this uses Chang's d3.parcoords javascript library that is built on top of d3 

        var pc1, pc2;
        var colorgen = d3.scale.ordinal()
            .range(["#a6cee3","#1f78b4","#b2df8a","#33a02c",
                "#fb9a99","#e31a1c","#fdbf6f","#ff7f00",
                "#cab2d6","#6a3d9a","#ffff99","#b15928"]);

        // load csv file and create the chart
        d3.csv('data/alldata-batch.csv', function(data) {
            var color = function(d) { return colorgen(d.batch); };
            //var parcoords = d3.parcoords()("#batch")
            pc1 = d3.parcoords()("#batch")
                .data(data)
                .color(color)
                .alpha(0.25)
                .composite("darker")
                .margin({ top: 54, left: 50, bottom: 12, right: 0 })
                .mode("queue")
                .autoscale()
                .render()
                .createAxes()
                .reorderable()
                .shadows()
                .brushMode("1D-axes");  // enable brushing

            pc1.svg.selectAll("text")
                .style("font", "10px sans-serif");

        });

        // load csv file and create the chart
        d3.csv('data/alldata-gvt.csv', function(data) {
            var color = function(d) { return colorgen(d.gvt); };

            //var parcoords = d3.parcoords()("#gvt")
            pc2 = d3.parcoords()("#gvt")
                .data(data)
                .color(color)
                .alpha(0.25)
                .composite("darker")
                .margin({ top: 54, left: 50, bottom: 12, right: 0 })
                .mode("queue")
                .render()
                .reorderable()
                .shadows()
                .brushMode("1D-axes");  // enable brushing

            pc2.svg.selectAll("text")
                .style("font", "10px sans-serif");
        });

        // to change on changing checkboxes
        var changeAxes = function(){
            var whichAxes = [];
            if (d3.select("#gvtComps").property("checked")){ 
                whichAxes.push("Total GVT Computations");
            }
            if (d3.select("#allRed").property("checked")){ 
                whichAxes.push("Total All Reduce Calls");
            }
            if (d3.select("#avgRed").property("checked")){ 
                whichAxes.push("Average Reduction / GVT");
            }
            if (d3.select("#totalProc").property("checked")){ 
                whichAxes.push("total events processes");
            }
            if (d3.select("#eventsRB").property("checked")){ 
                whichAxes.push("events rolled back");
            }
            if (d3.select("#efficiency").property("checked")){ 
                whichAxes.push("efficiency");
            }
            if (d3.select("#totalRem").property("checked")){ 
                whichAxes.push("total remote network events processed");
            }
            if (d3.select("#perRem").property("checked")){ 
                whichAxes.push("percent remote events");
            }
            if (d3.select("#totalRB").property("checked")){ 
                whichAxes.push("total rollbacks");
            }
            if (d3.select("#primaryRB").property("checked")){ 
                whichAxes.push("primary rollbacks");
            }
            if (d3.select("#secondaryRB").property("checked")){ 
                whichAxes.push("secondary roll backs");
            }
            if (d3.select("#fossilCollect").property("checked")){ 
                whichAxes.push("fossil collect attempts");
            }
            if (d3.select("#netevents").property("checked")){ 
                whichAxes.push("net events processed");
            }
            if (d3.select("#remoteSends").property("checked")){ 
                whichAxes.push("remote sends");
            }
            if (d3.select("#remoteRecvs").property("checked")){ 
                whichAxes.push("remote recvs");
            }

            var gvtAxes = whichAxes.slice();
            whichAxes.splice(0, 0, "batch");
            pc1.detectDimensions()
                .dimensions(whichAxes)
                .render()
                .updateAxes();

            gvtAxes.splice(0, 0, "gvt");
            pc2.detectDimensions()
                .dimensions(gvtAxes)
                .render()
                .updateAxes();
            
        };


    </script>
    <div id="batch" class="parcoords" style="width:1360px;height:550px"></div>
    <div id="gvt" class="parcoords" style="width:1360px;height:550px"></div>
    <div id="metricSelections" style="width:1360px;height:200px">
        Uncheck boxes to hide axes from the display </br>
        <input type="checkbox" class="filter_button" id="gvtComps" onchange="changeAxes()" checked>Total GVT Computations</input>
        <input type="checkbox" class="filter_button" id="allRed" onchange="changeAxes()" checked>AllReduce calls</input>
        <input type="checkbox" class="filter_button" id="avgRed" onchange="changeAxes()" checked>Average Reduction/GVT</input>
        <input type="checkbox" class="filter_button" id="totalProc" onchange="changeAxes()" checked>Total events processed</input>
        <input type="checkbox" class="filter_button" id="eventsRB" onchange="changeAxes()" checked>events rolled back</input></br>
        <input type="checkbox" class="filter_button" id="efficiency" onchange="changeAxes()" checked>efficiency</input>
        <input type="checkbox" class="filter_button" id="totalRem" onchange="changeAxes()" checked>total remote (network) events processed</input>
        <input type="checkbox" class="filter_button" id="perRem" onchange="changeAxes()" checked>percent remote events</input>
        <input type="checkbox" class="filter_button" id="totalRB" onchange="changeAxes()" checked>total roll backs</input>
        <input type="checkbox" class="filter_button" id="primaryRB" onchange="changeAxes()" checked>primary roll backs</input></br>
        <input type="checkbox" class="filter_button" id="secondaryRB" onchange="changeAxes()" checked>secondary roll backs</input>
        <input type="checkbox" class="filter_button" id="fossilCollect" onchange="changeAxes()" checked>fossil collect attempts</input>
        <input type="checkbox" class="filter_button" id="netevents" onchange="changeAxes()" checked>net events processed</input>
        <input type="checkbox" class="filter_button" id="remoteSends" onchange="changeAxes()" checked>remote sends</input>
        <input type="checkbox" class="filter_button" id="remoteRecvs" onchange="changeAxes()" checked>remote recvs</input>
    </div>
    </body>
</html>
